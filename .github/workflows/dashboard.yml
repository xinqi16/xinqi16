name: Generate Dashboard (No LeetCode)

on:
  schedule:
    - cron: "0 0 * * *" 
  workflow_dispatch:
  push:
    branches:
    - master

jobs:
  generate-snake:
    permissions: 
      contents: write
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
      - name: generate github-contribution-grid-snake.svg
        uses: Platane/snk/svg-only@v3
        with:
          github_user_name: ${{ github.repository_owner }}  # ğŸ‘ˆ é»˜è®¤æ˜¯ä»“åº“æ‰€æœ‰è€…ï¼Œå¦‚éœ€æŒ‡å®šå…¶ä»–ç”¨æˆ·ï¼ˆå¦‚ä½ è‡ªå·±çš„ GitHub ç”¨æˆ·åï¼‰ï¼Œè¯·æ”¹ä¸ºï¼šyour-github-username
          outputs: |
            dist/github-contribution-grid-snake.svg
            dist/github-contribution-grid-snake-dark.svg?palette=github-dark
          
      - name: push github-contribution-grid-snake.svg to the output branch
        uses: crazy-max/ghaction-github-pages@v3.1.0
        with:
          target_branch: output  # ğŸ‘ˆ å¦‚æœä½ æƒ³æ¨é€åˆ°å…¶ä»–åˆ†æ”¯ï¼ˆå¦‚ gh-pagesï¼‰ï¼Œè¯·ä¿®æ”¹è¿™é‡Œ
          build_dir: dist
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  github-metrics:
    runs-on: ubuntu-latest
    environment: 
      name: production
    permissions:
      contents: write
    steps:
      - name: left-side (no leetcode)
        uses: lowlighter/metrics@latest
        with:
          output_action: gist
          committer_gist: b3a3e28782078b93f3b0709099ebcef2  # ğŸ‘ˆ æ›¿æ¢ä¸ºä½ è‡ªå·±çš„å·¦ä¾§ Gist IDï¼ˆåˆ›å»ºç©º Gist åå¤åˆ¶ IDï¼‰
          token: ${{ secrets.METRICS_TOKEN }}  # ğŸ‘ˆ ç¡®ä¿ä½ å·²è®¾ç½®è¿™ä¸ª Secretï¼ˆGitHub Tokenï¼‰
          config_timezone: Asia/Shanghai  # ğŸ‘ˆ å¯é€‰ï¼šä¿®æ”¹ä¸ºä½ æ‰€åœ¨çš„æ—¶åŒºï¼Œå¦‚ America/New_York
          template: classic  # ğŸ‘ˆ å¯é€‰ï¼šæ”¹ä¸º 'compact', 'modern' ç­‰æ ·å¼
          base: header
          plugin_isocalendar: yes
          plugin_languages: yes
          repositories_skipped: |
            pandacase.github.io,
            openwrt,
            sysu-fa23-ds-hw6,
            mit6.S081-gitbook,
            mit6.824-gitbook,
            sysu-fa23-ml-recommendationSys
          # ğŸ‘ˆ å¦‚éœ€å¿½ç•¥æ›´å¤šä»“åº“ï¼Œè¯·åœ¨æ­¤æ·»åŠ ï¼Œæ¯è¡Œä¸€ä¸ª
          plugin_languages_colors: github  # ğŸ‘ˆ å¯é€‰ï¼šæ”¹ä¸º 'custom' å¹¶è‡ªå®šä¹‰é¢œè‰²
          plugin_languages_details: lines, percentage
          plugin_languages_indepth: yes
          config_order: base.header, isocalendar, languages

      - name: right-side
        uses: lowlighter/metrics@latest
        with:
          output_action: gist
          committer_gist: 9440cfcbb8292038210f8f17195b6e2b  # ğŸ‘ˆ æ›¿æ¢ä¸ºä½ è‡ªå·±çš„å³ä¾§ Gist ID
          token: ${{ secrets.METRICS_TOKEN }}
          config_timezone: Asia/Shanghai
          template: classic
          base: ""
          plugin_achievements: yes
          plugin_achievements_limit: 8  # ğŸ‘ˆ å¯é€‰ï¼šè°ƒæ•´æˆå°±å¾½ç« æ•°é‡ï¼ˆæœ€å¤š 20ï¼‰
          plugin_topics: yes
          plugin_topics_mode: icons  # ğŸ‘ˆ å¯é€‰ï¼šæ”¹ä¸º 'list' æˆ– 'cloud'
          plugin_topics_limit: 0  # ğŸ‘ˆ 0 è¡¨ç¤ºä¸é™åˆ¶ï¼Œå¯è®¾ä¸º 5ã€10 ç­‰
          plugin_habits: yes
          plugin_habits_facts: yes
          plugin_habits_charts: no  # ğŸ‘ˆ è®¾ä¸º yes å¯æ˜¾ç¤ºå›¾è¡¨ï¼ˆä½†ä¼šæ›´å ç©ºé—´ï¼‰
          plugin_rss: no  # ğŸ‘ˆ å¦‚éœ€æ˜¾ç¤ºåšå®¢ RSSï¼Œè®¾ä¸º yes å¹¶å¡«å†™ source
          # plugin_rss_source: https://yzr-mint.github.io/feed.xml  # ğŸ‘ˆ å¦‚æœå¯ç”¨ RSSï¼Œè¯·å–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹ URL
          # plugin_rss_limit: 3
          config_order: achievements, habits, topics